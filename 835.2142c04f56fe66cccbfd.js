(()=>{"use strict";var t=["vis-type","instanceId","type","x","y","z","xrot","yrot","zrot","cr","nSubPoints"];function e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function n(t,e){return n=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},n(t,e)}function o(t){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},o(t)}function a(t,e){if(e&&("object"===o(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return r(t)}function u(t){return u=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},u(t)}function c(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function i(t,e,r){return i=c()?Reflect.construct.bind():function(t,e,r){var o=[null];o.push.apply(o,e);var a=new(Function.bind.apply(t,o));return r&&n(a,r.prototype),a},i.apply(null,arguments)}function f(t){var e="function"==typeof Map?new Map:void 0;return f=function(t){if(null===t||(r=t,-1===Function.toString.call(r).indexOf("[native code]")))return t;var r;if("function"!=typeof t)throw new TypeError("Super expression must either be null or a function");if(void 0!==e){if(e.has(t))return e.get(t);e.set(t,o)}function o(){return i(t,arguments,u(this).constructor)}return o.prototype=Object.create(t.prototype,{constructor:{value:o,enumerable:!1,writable:!0,configurable:!0}}),n(o,t)},f(t)}function l(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var p=function(t){return t.ERROR="error",t.INFO="info",t.WARNING="warning",t}({}),s=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&n(t,e)}(s,t);var o,c,i,f=(c=s,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=u(c);if(i){var r=u(this).constructor;t=Reflect.construct(e,arguments,r)}else t=e.apply(this,arguments);return a(this,t)});function s(t){var n,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:p.ERROR,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";e(this,s);for(var u=arguments.length,c=new Array(u>3?u-3:0),i=3;i<u;i++)c[i-3]=arguments[i];return l(r(n=f.call.apply(f,[this].concat(c))),"htmlData",void 0),l(r(n),"level",void 0),n.name="FrontEndError",n.message=t,n.htmlData=a,n.level=o,n}return o=s,Object.defineProperty(o,"prototype",{writable:!1}),o}(f(Error));self.addEventListener("message",(function(e){var r=function(e){var r=[],n=[];return e.bundleData.forEach((function(e){for(var o=e.data,a=[],u=t.findIndex((function(t){return"nSubPoints"===t})),c=function(){var e=o[u],r=t.length+e;if(o.length<r){var n=t.map((function(t,e){return"".concat(t,": ").concat(o[e],"<br />")}));throw new s("Your data is malformed, there are too few entries.",p.ERROR,"Example attempt to parse your data: <pre>".concat(n.join(""),"</pre>"))}var c=o.splice(0,r);if(c.length<t.length){var i=t.map((function(t,e){return"".concat(t,": ").concat(c[e],"<br />")}));throw new s("Your data is malformed, there are less entries than expected for this agent. ",p.ERROR,"Example attempt to parse your data: <pre>".concat(i.join(""),"</pre>"))}var f,l=(f=c).reduce((function(e,r,n){return t[n]?e[t[n]]=r:n<f.length+e.nSubPoints&&e.subpoints.push(r),e}),{subpoints:[]});a.push(l)};o.length;)c();var i={time:e.time,frameNumber:e.frameNumber};r.push(a),n.push(i)})),{parsedAgentDataArray:r,frameDataArray:n}}(e.data),n=r.frameDataArray,o=r.parsedAgentDataArray;postMessage({frameDataArray:n,parsedAgentDataArray:o})}),!1)})();